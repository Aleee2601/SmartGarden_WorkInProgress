<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converters="clr-namespace:SmartGarden_WorkInProgress.Converters"
             x:Class="SmartGarden_WorkInProgress.Controls.AutoWateringControl"
             x:Name="this">
    <ContentView.Resources>
        <converters:BoolToOpacityConverter x:Key="BoolToOpacityConverter" />
    </ContentView.Resources>

    <VerticalStackLayout Spacing="16">
        <!-- Header with Switch -->
        <Grid ColumnDefinitions="*,Auto">
            <Label Grid.Column="0"
                   Text="Automatic watering"
                   FontSize="18"
                   FontAttributes="Bold"
                   TextColor="{StaticResource ColorText}"
                   VerticalOptions="Center" />
            <Switch Grid.Column="1"
                    IsToggled="{Binding IsOn, Source={x:Reference this}}"
                    OnColor="{StaticResource ColorPrimary}"
                    VerticalOptions="Center" />
        </Grid>

        <!-- Segmented Control -->
        <Grid ColumnDefinitions="*,*"
              HeightRequest="40"
              Opacity="{Binding IsOn, Source={x:Reference this}, Converter={StaticResource BoolToOpacityConverter}}">
            <Frame Grid.Column="0"
                   Padding="0"
                   CornerRadius="10"
                   HasShadow="False"
                   BorderColor="{StaticResource ColorPrimary}">
                <Frame.BackgroundColor>
                    <MultiBinding Converter="{StaticResource SegmentBackgroundConverter}">
                        <Binding Path="IsOn" Source="{x:Reference this}" />
                        <Binding Source="True" />
                    </MultiBinding>
                </Frame.BackgroundColor>
                <Label Text="ON"
                       FontSize="14"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       VerticalOptions="Center">
                    <Label.TextColor>
                        <MultiBinding Converter="{StaticResource SegmentTextColorConverter}">
                            <Binding Path="IsOn" Source="{x:Reference this}" />
                            <Binding Source="True" />
                        </MultiBinding>
                    </Label.TextColor>
                </Label>
            </Frame>

            <Frame Grid.Column="1"
                   Padding="0"
                   CornerRadius="10"
                   HasShadow="False"
                   BorderColor="{StaticResource ColorPrimary}">
                <Frame.BackgroundColor>
                    <MultiBinding Converter="{StaticResource SegmentBackgroundConverter}">
                        <Binding Path="IsOn" Source="{x:Reference this}" />
                        <Binding Source="False" />
                    </MultiBinding>
                </Frame.BackgroundColor>
                <Label Text="OFF"
                       FontSize="14"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       VerticalOptions="Center">
                    <Label.TextColor>
                        <MultiBinding Converter="{StaticResource SegmentTextColorConverter}">
                            <Binding Path="IsOn" Source="{x:Reference this}" />
                            <Binding Source="False" />
                        </MultiBinding>
                    </Label.TextColor>
                </Label>
            </Frame>
        </Grid>

        <!-- Slider -->
        <Slider Minimum="0"
                Maximum="100"
                Value="{Binding Intensity, Source={x:Reference this}}"
                MinimumTrackColor="{StaticResource ColorPrimary}"
                MaximumTrackColor="{StaticResource ColorSurfaceAlt}"
                IsEnabled="{Binding IsOn, Source={x:Reference this}}"
                Opacity="{Binding IsOn, Source={x:Reference this}, Converter={StaticResource BoolToOpacityConverter}}" />

        <!-- Indicator Dots -->
        <HorizontalStackLayout Spacing="8"
                               HorizontalOptions="Center"
                               Opacity="{Binding IsOn, Source={x:Reference this}, Converter={StaticResource BoolToOpacityConverter}}">
            <BoxView WidthRequest="8"
                     HeightRequest="8"
                     CornerRadius="4"
                     BackgroundColor="{StaticResource ColorSubtle}" />
            <BoxView WidthRequest="8"
                     HeightRequest="8"
                     CornerRadius="4"
                     BackgroundColor="{StaticResource ColorSubtle}" />
            <BoxView WidthRequest="8"
                     HeightRequest="8"
                     CornerRadius="4"
                     BackgroundColor="{StaticResource ColorSubtle}" />
        </HorizontalStackLayout>
    </VerticalStackLayout>
</ContentView>
